<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class AIX::Errlog::Match - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-21">#!</a>
    
    <li ><a href="#method-i-21-3D">#!=</a>
    
    <li ><a href="#method-i-26">#&amp;</a>
    
    <li ><a href="#method-i-3C">#&lt;</a>
    
    <li ><a href="#method-i-3C-3D">#&lt;=</a>
    
    <li ><a href="#method-i-3D-3D">#==</a>
    
    <li ><a href="#method-i-3E">#&gt;</a>
    
    <li ><a href="#method-i-3E-3D">#&gt;=</a>
    
    <li ><a href="#method-i-5E">#^</a>
    
    <li ><a href="#method-i-include-3F">#include?</a>
    
    <li ><a href="#method-i-to_struct">#to_struct</a>
    
    <li ><a href="#method-i-7C">#|</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-AIX::Errlog::Match">
  <h1 id="class-AIX::Errlog::Match" class="class">
    class AIX::Errlog::Match
  </h1>

  <section class="description">
    
<p>A class that is useful for building errlog matchers.</p>

<p>You usually won&#39;t need to access this class directly; you&#39;ll be
able to create instances of it indirectly through the field accessors that
are available in <a href="Errlog.html">Errlog</a>.</p>

<p>You can build field matchers using the methods on the errlog and standard
logical operators, and there are standard conversions for certain things
like Time and DateTime operations.  For instance, if you wanted errlog
entries only in January 2018 with <code>FOO</code> in the label somewhere,
you cold use a match like this with an <a href="Errlog.html">Errlog</a>
instance.</p>

<pre class="ruby">(
  (<span class="ruby-identifier">errlog</span>.<span class="ruby-identifier">match_timestamp</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2018</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>)) <span class="ruby-operator">&amp;</span>
  (<span class="ruby-identifier">errlog</span>.<span class="ruby-identifier">match_timestamp</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2018</span>, <span class="ruby-value">2</span>, <span class="ruby-value">1</span>)) <span class="ruby-operator">&amp;</span>
  <span class="ruby-identifier">errlog</span>.<span class="ruby-identifier">match_label</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&#39;FOO&#39;</span>)
)
</pre>

<p>It really is that easy.  The rest of the magic is done for you behind the
scenes, as long as you follow the rules and know how to make these matches
in the C equivalent.  Note that there must always be a <a
href="Match.html">Match</a> on the left side of all comparisons, so
something like</p>

<pre class="ruby"><span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2018</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>) <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">errlog</span>.<span class="ruby-identifier">match_timestamp</span>
</pre>

<p>is not possible.</p>

<p>This class should allow you to build matches for errlog_find_first in a
simple and natural way.  Note that &amp; is the <code>LE_OP_AND</code>
operator, and | is the <code>LE_OP_OR</code> operator, not &amp;&amp;,
<code>and</code>, ||, or <code>or</code>, because those can&#39;t be
overridden.</p>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-left" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">left</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-operator" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">operator</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-right" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">right</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(left:, operator: nil, right: nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 43</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-value">left:</span>, <span class="ruby-value">operator:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">right:</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@left</span> = <span class="ruby-identifier">left</span>
  <span class="ruby-ivar">@operator</span> = <span class="ruby-identifier">operator</span>
  <span class="ruby-ivar">@right</span> = <span class="ruby-identifier">right</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="21-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 148</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">!</span>
  <span class="ruby-constant">Match</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">left:</span> <span class="ruby-keyword">self</span>,
    <span class="ruby-value">operator:</span> <span class="ruby-value">:not</span>,
  )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-21-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">!=</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="21-3D-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 97</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">!=</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@operator</span> = <span class="ruby-value">:ne</span>
  <span class="ruby-ivar">@right</span> = <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-26" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">&amp;</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="26-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 127</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">&amp;</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-constant">Match</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">left:</span> <span class="ruby-keyword">self</span>,
    <span class="ruby-value">operator:</span> <span class="ruby-value">:and</span>,
    <span class="ruby-value">right:</span> <span class="ruby-identifier">other</span>,
  )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-3C" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">&lt;</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="3C-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">&lt;</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@operator</span> = <span class="ruby-value">:lt</span>
  <span class="ruby-ivar">@right</span> = <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-3C-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">&lt;=</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="3C-3D-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 112</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">&lt;=</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@operator</span> = <span class="ruby-value">:le</span>
  <span class="ruby-ivar">@right</span> = <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-3D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">==</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="3D-3D-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 92</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">==</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@operator</span> = <span class="ruby-value">:equal</span>
  <span class="ruby-ivar">@right</span> = <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-3E" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">&gt;</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="3E-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 117</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">&gt;</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@operator</span> = <span class="ruby-value">:gt</span>
  <span class="ruby-ivar">@right</span> = <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-3E-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">&gt;=</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="3E-3D-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 122</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">&gt;=</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@operator</span> = <span class="ruby-value">:ge</span>
  <span class="ruby-ivar">@right</span> = <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-5E" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">^</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="5E-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 141</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">^</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-constant">Match</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">left:</span> <span class="ruby-keyword">self</span>,
    <span class="ruby-value">operator:</span> <span class="ruby-value">:xor</span>,
    <span class="ruby-value">right:</span> <span class="ruby-identifier">other</span>,
  )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-include-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">include?</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="include-3F-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 102</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">include?</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@operator</span> = <span class="ruby-value">:substr</span>
  <span class="ruby-ivar">@right</span> = <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_struct" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_struct</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Uses the structure of this object to build a errlog_match_t structure. Does
not check whether operators only work on leaves or any other specifics as
that (for instance, an and operator needs two <a
href="Match.html">Match</a> leaves, and won&#39;t work between a field and
a <a href="Match.html">Match</a> or anything like that).  The function
itself might check some of the operators to make sure that they&#39;re set
and throw an error for you, but something like a segfault is more likely if
you screw up the structure.  Make sure you know what you&#39;re doing.</p>
          
          

          
          <div class="method-source-code" id="to_struct-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 57</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">to_struct</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;operator must be a symbol, but is #{@operator}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@operator</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Symbol</span>

  <span class="ruby-comment"># We want to be sure the struct is not garbage collected before it&#39;s</span>
  <span class="ruby-comment"># used, so we need to retain a reference to it that ensures that it will</span>
  <span class="ruby-comment"># live as long as this object</span>
  <span class="ruby-ivar">@struct</span> = <span class="ruby-constant">Lib</span><span class="ruby-operator">::</span><span class="ruby-constant">ErrlogMatch</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-ivar">@struct</span>[<span class="ruby-value">:em_op</span>] = <span class="ruby-ivar">@operator</span>

  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@left</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Match</span>
    <span class="ruby-ivar">@struct</span>[<span class="ruby-value">:emu1</span>][<span class="ruby-value">:emu_left</span>] = <span class="ruby-ivar">@left</span>.<span class="ruby-identifier">to_struct</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>
    <span class="ruby-ivar">@struct</span>[<span class="ruby-value">:emu1</span>][<span class="ruby-value">:emu_field</span>] = <span class="ruby-ivar">@left</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;left should be either a Match or Symbol object, but is #{@left}&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@right</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Match</span>
    <span class="ruby-ivar">@struct</span>[<span class="ruby-value">:emu2</span>][<span class="ruby-value">:emu_right</span>] = <span class="ruby-ivar">@right</span>.<span class="ruby-identifier">to_struct</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
    <span class="ruby-ivar">@struct</span>[<span class="ruby-value">:emu2</span>][<span class="ruby-value">:emu_strvalue</span>] = <span class="ruby-ivar">@right</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Numeric</span>, <span class="ruby-constant">Time</span>
    <span class="ruby-ivar">@struct</span>[<span class="ruby-value">:emu2</span>][<span class="ruby-value">:emu_intvalue</span>] = <span class="ruby-ivar">@right</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">DateTime</span>
    <span class="ruby-ivar">@struct</span>[<span class="ruby-value">:emu2</span>][<span class="ruby-value">:emu_intvalue</span>] = <span class="ruby-ivar">@right</span>.<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;left should be either a Match or Symbol object, but is #{@left}&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@struct</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-7C" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">|</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="7C-source">
            <pre><span class="ruby-comment"># File lib/aix/errlog/match.rb, line 134</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">|</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-constant">Match</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">left:</span> <span class="ruby-keyword">self</span>,
    <span class="ruby-value">operator:</span> <span class="ruby-value">:or</span>,
    <span class="ruby-value">right:</span> <span class="ruby-identifier">other</span>,
  )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.0.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

